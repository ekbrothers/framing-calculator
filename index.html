<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Framing Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* =====================
           CSS STYLES
           ===================== */
        :root {
            --primary-color: #BB86FC;
            --primary-variant: #3700B3;
            --secondary-color: #03DAC6;
            --background: #121212;
            --surface: #1E1E1E;
            --error: #CF6679;
            --on-primary: #000000;
            --on-background: #FFFFFF;
            --on-surface: #FFFFFF;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background);
            color: var(--on-background);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2 {
            color: var(--primary-color);
            text-align: center;
        }

        form {
            background-color: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: var(--on-surface);
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            background-color: var(--background);
            border: 1px solid var(--primary-color);
            border-radius: 4px;
            color: var(--on-background);
        }

        input[type="number"],
        select {
            width: 70px;
        }

        button {
            background-color: var(--primary-color);
            color: var(--on-primary);
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: var(--primary-variant);
        }

        .error {
            color: var(--error);
            font-size: 0.9em;
            margin-top: -10px;
            margin-bottom: 10px;
        }

        .dimension-input {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .dimension-input label {
            margin-right: 10px;
            width: 100px;
        }

        #results, #suggestions {
            margin-top: 20px;
            background-color: var(--surface);
            padding: 20px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Framing Calculator</h1>
        
        <form id="framingForm" novalidate>
            <!-- =====================
                 ARTWORK NAME INPUT
                 ===================== -->
            <h2>Artwork Information</h2>
            <div class="dimension-input">
                <label for="artworkName">Artwork Name:</label>
                <input type="text" id="artworkName" required>
            </div>

            <!-- =====================
                 SIGHT SIZE INPUTS
                 ===================== -->
            <h2>Sight Size</h2>
            <div class="dimension-input">
                <label for="sightSizeWidthWhole">Width:</label>
                <input type="number" id="sightSizeWidthWhole" min="0" max="100" required>
                <select id="sightSizeWidthFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="sightSizeHeightWhole">Height:</label>
                <input type="number" id="sightSizeHeightWhole" min="0" max="100" required>
                <select id="sightSizeHeightFraction"></select>
            </div>

            <!-- =====================
                 OVERALL SIZE INPUTS
                 ===================== -->
            <h2>Overall Size</h2>
            <div class="dimension-input">
                <label for="overallSizeWidthWhole">Width:</label>
                <input type="number" id="overallSizeWidthWhole" min="0" max="100" required>
                <select id="overallSizeWidthFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="overallSizeHeightWhole">Height:</label>
                <input type="number" id="overallSizeHeightWhole" min="0" max="100" required>
                <select id="overallSizeHeightFraction"></select>
            </div>

            <!-- =====================
                 MAT SIZE INPUTS
                 ===================== -->
            <h2>Mat Size</h2>
            <div class="dimension-input">
                <label for="matSizeTopWhole">Top:</label>
                <input type="number" id="matSizeTopWhole" min="0" max="100" required>
                <select id="matSizeTopFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="matSizeRightWhole">Right:</label>
                <input type="number" id="matSizeRightWhole" min="0" max="100" required>
                <select id="matSizeRightFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="matSizeBottomWhole">Bottom:</label>
                <input type="number" id="matSizeBottomWhole" min="0" max="100" required>
                <select id="matSizeBottomFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="matSizeLeftWhole">Left:</label>
                <input type="number" id="matSizeLeftWhole" min="0" max="100" required>
                <select id="matSizeLeftFraction"></select>
            </div>

            <!-- =====================
                 RABBIT SIZE INPUT
                 ===================== -->
            <h2>Rabbit Size</h2>
            <div class="dimension-input">
                <label for="rabbitSizeWhole">Size:</label>
                <input type="number" id="rabbitSizeWhole" min="0" max="100" value="0.25" required>
                <select id="rabbitSizeFraction"></select>
            </div>

            <button type="button" onclick="validateAndCalculate()">Calculate</button>
        </form>

        <div id="suggestions"></div>
        <div id="results"></div>

        <button onclick="generatePDF()">Export to PDF</button>
    </div>

    <script>
        /* =====================
           JAVASCRIPT FUNCTIONS
           ===================== */

        // Fraction options
        const fractions = [
            {value: 0, text: "0"},
            {value: 0.0625, text: "1/16"},
            {value: 0.125, text: "1/8"},
            {value: 0.1875, text: "3/16"},
            {value: 0.25, text: "1/4"},
            {value: 0.3125, text: "5/16"},
            {value: 0.375, text: "3/8"},
            {value: 0.4375, text: "7/16"},
            {value: 0.5, text: "1/2"},
            {value: 0.5625, text: "9/16"},
            {value: 0.625, text: "5/8"},
            {value: 0.6875, text: "11/16"},
            {value: 0.75, text: "3/4"},
            {value: 0.8125, text: "13/16"},
            {value: 0.875, text: "7/8"},
            {value: 0.9375, text: "15/16"}
        ];

        // Populate fraction dropdowns
        function populateFractionDropdowns() {
            const fractionSelects = document.querySelectorAll('select');
            fractionSelects.forEach(select => {
                fractions.forEach(fraction => {
                    const option = document.createElement('option');
                    option.value = fraction.value;
                    option.textContent = fraction.text;
                    select.appendChild(option);
                });
            });
        }

        // Validate and calculate
        function validateAndCalculate() {
            if (validateForm()) {
                calculate();
            }
        }

        // Form validation
        function validateForm() {
            // Implement form validation logic here
            return true; // Placeholder
        }

        // Main calculation function
        function calculate() {
            // Gather input values
            const artworkName = document.getElementById('artworkName').value;
            const sightSize = {
                width: getInputValue('sightSizeWidth'),
                height: getInputValue('sightSizeHeight')
            };
            const overallSize = {
                width: getInputValue('overallSizeWidth'),
                height: getInputValue('overallSizeHeight')
            };
            const matSize = {
                top: getInputValue('matSizeTop'),
                right: getInputValue('matSizeRight'),
                bottom: getInputValue('matSizeBottom'),
                left: getInputValue('matSizeLeft')
            };
            const rabbitSize = getInputValue('rabbitSize');

            // Perform calculations
            const matOpening = calculateMatOpening(sightSize);
            const fullMatSize = calculateFullMatSize(matOpening, matSize, rabbitSize);
            const innerFrameDiameter = calculateInnerFrameDiameter(fullMatSize);

            // Display results
            displayResults(artworkName, sightSize, matSize, matOpening, fullMatSize, innerFrameDiameter);
            displaySuggestions(sightSize, matSize);
        }

        // Get input value (whole + fraction)
        function getInputValue(inputId) {
            const whole = parseFloat(document.getElementById(inputId + 'Whole').value) || 0;
            const fraction = parseFloat(document.getElementById(inputId + 'Fraction').value) || 0;
            return whole + fraction;
        }

        // Calculate mat opening
        function calculateMatOpening(sightSize) {
            return {
                width: sightSize.width,
                height: sightSize.height
            };
        }

        // Calculate full mat size
        function calculateFullMatSize(matOpening, matSize, rabbitSize) {
            const adjustment = 1/16; // 1/16 inch adjustment
            return {
                width: matOpening.width + matSize.left + matSize.right + (2 * rabbitSize) - (2 * adjustment),
                height: matOpening.height + matSize.top + matSize.bottom + (2 * rabbitSize) - (2 * adjustment)
            };
        }

        // Calculate inner frame diameter
        function calculateInnerFrameDiameter(fullMatSize) {
            return {
                width: fullMatSize.width,
                height: fullMatSize.height
            };
        }

        // Display results
        function displayResults(artworkName, sightSize, matSize, matOpening, fullMatSize, innerFrameDiameter) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h2>Results for "${artworkName}"</h2>
                <p>Artwork Sight Size: ${sightSize.width.toFixed(4)} x ${sightSize.height.toFixed(4)} inches</p>
                <p>Mat Size: Top ${matSize.top.toFixed(4)}", Right ${matSize.right.toFixed(4)}", Bottom ${matSize.bottom.toFixed(4)}", Left ${matSize.left.toFixed(4)}"</p>
                <p>Mat Opening: ${matOpening.width.toFixed(4)} x ${matOpening.height.toFixed(4)} inches</p>
                <p>Full Mat Size: ${fullMatSize.width.toFixed(4)} x ${fullMatSize.height.toFixed(4)} inches</p>
                <p>Inner Frame Diameter: ${innerFrameDiameter.width.toFixed(4)} x ${innerFrameDiameter.height.toFixed(4)} inches</p>
            `;
        }

        // Display suggestions
        function displaySuggestions(sightSize, matSize) {
            const suggestionsDiv = document.getElementById('suggestions');
            const smallArtworkThreshold = 11; // Threshold for small artwork (in inches)
            const isSmallArtwork = sightSize.width < smallArtworkThreshold || sightSize.height < smallArtworkThreshold;

            if (isSmallArtwork) {
                const suggestedMatSize = Math.max(3, Math.min(sightSize.width, sightSize.height) * 0.25);
                suggestionsDiv.innerHTML = `
                    <h2>Suggestions</h2>
                    <p>For smaller artwork, consider using a larger mat to maintain aesthetic balance.</p>
                    <p>Suggested mat size: ${suggestedMatSize.toFixed(2)} inches on all sides.</p>
                `;
            } else {
                suggestionsDiv.innerHTML = ''; // Clear suggestions for larger artwork
            }
        }

        // Generate PDF
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Add content to the PDF
            doc.setFontSize(18);
            doc.text("Framing Calculator Results", 105, 15, null, null, "center");

            doc.setFontSize(12);
            const artworkName = document.getElementById('artworkName').value;
            doc.text(`Artwork: ${artworkName}`, 20, 30);

            // Add more content (you can expand this to include all calculations)
            const resultsDiv = document.getElementById('results');
            const resultsText = resultsDiv.innerText;
            const lines = doc.splitTextToSize(resultsText, 180);
            doc.text(lines, 20, 40);

            const suggestionsDiv = document.getElementById('suggestions');
            const suggestionsText = suggestionsDiv.innerText;
            const suggestionLines = doc.splitTextToSize(suggestionsText, 180);
            doc.text(suggestionLines, 20, 100);

            // Save the PDF
            doc.save("Framing_Calculator_Results.pdf");
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            populateFractionDropdowns();
        });
    </script>
</body>
</html>