<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Framing Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary-color: #BB86FC;
            --primary-variant: #3700B3;
            --secondary-color: #03DAC6;
            --background: #121212;
            --surface: #1E1E1E;
            --error: #CF6679;
            --on-primary: #000000;
            --on-background: #FFFFFF;
            --on-surface: #FFFFFF;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background);
            color: var(--on-background);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2 {
            color: var(--primary-color);
            text-align: center;
        }

        form {
            background-color: var(--surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: var(--on-surface);
        }

        input[type="number"], select {
            width: 70px;
            padding: 10px;
            margin-bottom: 15px;
            background-color: var(--background);
            border: 1px solid var(--primary-color);
            border-radius: 4px;
            color: var(--on-background);
        }

        button {
            background-color: var(--primary-color);
            color: var(--on-primary);
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: var(--primary-variant);
        }

        .error {
            color: var(--error);
            font-size: 0.9em;
            margin-top: -10px;
            margin-bottom: 10px;
        }

        .dimension-input {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .dimension-input label {
            margin-right: 10px;
            width: 100px;
        }

        #results, #suggestions {
            margin-top: 20px;
            background-color: var(--surface);
            padding: 20px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Framing Calculator</h1>
        
        <form id="framingForm" novalidate>
            <h2>Sight Size</h2>
            <div class="dimension-input">
                <label for="sightSizeWidthWhole">Width:</label>
                <input type="number" id="sightSizeWidthWhole" min="0" max="100" required>
                <select id="sightSizeWidthFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="sightSizeHeightWhole">Height:</label>
                <input type="number" id="sightSizeHeightWhole" min="0" max="100" required>
                <select id="sightSizeHeightFraction"></select>
            </div>

            <h2>Overall Size</h2>
            <div class="dimension-input">
                <label for="overallSizeWidthWhole">Width:</label>
                <input type="number" id="overallSizeWidthWhole" min="0" max="100" required>
                <select id="overallSizeWidthFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="overallSizeHeightWhole">Height:</label>
                <input type="number" id="overallSizeHeightWhole" min="0" max="100" required>
                <select id="overallSizeHeightFraction"></select>
            </div>

            <h2>Mat Size</h2>
            <div class="dimension-input">
                <label for="matSizeTopWhole">Top:</label>
                <input type="number" id="matSizeTopWhole" min="0" max="100" required>
                <select id="matSizeTopFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="matSizeRightWhole">Right:</label>
                <input type="number" id="matSizeRightWhole" min="0" max="100" required>
                <select id="matSizeRightFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="matSizeBottomWhole">Bottom:</label>
                <input type="number" id="matSizeBottomWhole" min="0" max="100" required>
                <select id="matSizeBottomFraction"></select>
            </div>
            <div class="dimension-input">
                <label for="matSizeLeftWhole">Left:</label>
                <input type="number" id="matSizeLeftWhole" min="0" max="100" required>
                <select id="matSizeLeftFraction"></select>
            </div>

            <h2>Margin Size</h2>
            <div class="dimension-input">
                <label for="marginSizeWhole">Uniform:</label>
                <input type="number" id="marginSizeWhole" min="0" max="100" required>
                <select id="marginSizeFraction"></select>
            </div>
            <button type="button" id="customMarginBtn">Custom Margins</button>
            <div id="customMargins" style="display: none;">
                <div class="dimension-input">
                    <label for="marginSizeTopWhole">Top:</label>
                    <input type="number" id="marginSizeTopWhole" min="0" max="100">
                    <select id="marginSizeTopFraction"></select>
                </div>
                <div class="dimension-input">
                    <label for="marginSizeRightWhole">Right:</label>
                    <input type="number" id="marginSizeRightWhole" min="0" max="100">
                    <select id="marginSizeRightFraction"></select>
                </div>
                <div class="dimension-input">
                    <label for="marginSizeBottomWhole">Bottom:</label>
                    <input type="number" id="marginSizeBottomWhole" min="0" max="100">
                    <select id="marginSizeBottomFraction"></select>
                </div>
                <div class="dimension-input">
                    <label for="marginSizeLeftWhole">Left:</label>
                    <input type="number" id="marginSizeLeftWhole" min="0" max="100">
                    <select id="marginSizeLeftFraction"></select>
                </div>
            </div>

            <h2>Rabbit Size</h2>
            <div class="dimension-input">
                <label for="rabbitSizeWhole">Size:</label>
                <input type="number" id="rabbitSizeWhole" min="0" max="100" value="0.25" required>
                <select id="rabbitSizeFraction"></select>
            </div>

            <button type="button" onclick="validateAndCalculate()">Calculate</button>
        </form>

        <div id="suggestions"></div>
        <div id="results"></div>

        <button onclick="generatePDF()">Export to PDF</button>
    </div>

    <script>
        const fractions = [
            {value: 0, text: "0"},
            {value: 0.0625, text: "1/16"},
            {value: 0.125, text: "1/8"},
            {value: 0.1875, text: "3/16"},
            {value: 0.25, text: "1/4"},
            {value: 0.3125, text: "5/16"},
            {value: 0.375, text: "3/8"},
            {value: 0.4375, text: "7/16"},
            {value: 0.5, text: "1/2"},
            {value: 0.5625, text: "9/16"},
            {value: 0.625, text: "5/8"},
            {value: 0.6875, text: "11/16"},
            {value: 0.75, text: "3/4"},
            {value: 0.8125, text: "13/16"},
            {value: 0.875, text: "7/8"},
            {value: 0.9375, text: "15/16"}
        ];

        function populateFractionDropdowns() {
            const fractionSelects = document.querySelectorAll('select');
            fractionSelects.forEach(select => {
                fractions.forEach(fraction => {
                    const option = document.createElement('option');
                    option.value = fraction.value;
                    option.textContent = fraction.text;
                    select.appendChild(option);
                });
            });
        }

        function toggleCustomMargins() {
            const customMargins = document.getElementById('customMargins');
            customMargins.style.display = customMargins.style.display === 'none' ? 'block' : 'none';
        }

        function validateAndCalculate() {
            if (validateForm()) {
                calculate();
            }
        }

        function validateForm() {
            // Implement form validation logic here
            return true; // Placeholder
        }

        function calculate() {
            // Gather input values
            const sightSize = {
                width: getInputValue('sightSizeWidth'),
                height: getInputValue('sightSizeHeight')
            };
            const overallSize = {
                width: getInputValue('overallSizeWidth'),
                height: getInputValue('overallSizeHeight')
            };
            const matSize = {
                top: getInputValue('matSizeTop'),
                right: getInputValue('matSizeRight'),
                bottom: getInputValue('matSizeBottom'),
                left: getInputValue('matSizeLeft')
            };
            const marginSize = getMarginSize();
            const rabbitSize = getInputValue('rabbitSize');

            // Perform calculations
            const matOpening = calculateMatOpening(sightSize, marginSize);
            const fullMatSize = calculateFullMatSize(matOpening, matSize, rabbitSize);
            const innerFrameDiameter = calculateInnerFrameDiameter(fullMatSize);

            // Display results
            displayResults(matOpening, fullMatSize, innerFrameDiameter);
            displaySuggestions(sightSize, matSize);
        }

        function getInputValue(inputId) {
            const whole = parseFloat(document.getElementById(inputId + 'Whole').value) || 0;
            const fraction = parseFloat(document.getElementById(inputId + 'Fraction').value) || 0;
            return whole + fraction;
        }

        function getMarginSize() {
            const customMargins = document.getElementById('customMargins');
            if (customMargins.style.display === 'none') {
                const uniform = getInputValue('marginSize');
                return { top: uniform, right: uniform, bottom: uniform, left: uniform };
            } else {
                return {
                    top: getInputValue('marginSizeTop'),
                    right: getInputValue('marginSizeRight'),
                    bottom: getInputValue('marginSizeBottom'),
                    left: getInputValue('marginSizeLeft')
                };
            }
        }

        function calculateMatOpening(sightSize, marginSize) {
            return {
                width: sightSize.width + marginSize.left + marginSize.right,
                height: sightSize.height + marginSize.top + marginSize.bottom
            };
        }

        function calculateFullMatSize(matOpening, matSize, rabbitSize) {
            const adjustment = 1/16; // 1/16 inch adjustment
            return {
                width: matOpening.width + matSize.left + matSize.right + (2 * rabbitSize) - (2 * adjustment),
                height: matOpening.height + matSize.top + matSize.bottom + (2 * rabbitSize) - (2 * adjustment)
            };
        }

        function calculateInnerFrameDiameter(fullMatSize) {
            return {
                width: fullMatSize.width,
                height: fullMatSize.height
            };
        }

        function displayResults(matOpening, fullMatSize, innerFrameDiameter) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h2>Results</h2>
                <p>Mat Opening: ${matOpening.width.toFixed(4)} x ${matOpening.height.toFixed(4)} inches</p>
                <p>Full Mat Size: ${fullMatSize.width.toFixed(4)} x ${fullMatSize.height.toFixed(4)} inches</p>
                <p>Inner Frame Diameter: ${innerFrameDiameter.width.toFixed(4)} x ${innerFrameDiameter.height.toFixed(4)} inches</p>
            `;
        }

        function displaySuggestions(sightSize, matSize) {
            const suggestionsDiv = document.getElementById('suggestions');
            const smallArtworkThreshold = 11; // Threshold for small artwork (in inches)
            const isSmallArtwork = sightSize.width < smallArtworkThreshold || sightSize.height < smallArtworkThreshold;

            if (isSmallArtwork) {
                const suggestedMatSize = Math.max(3, Math.min(sightSize.width, sightSize.height) * 0.25);
                suggestionsDiv.innerHTML = `
                    <h2>Suggestions</h2>
                    <p>For smaller artwork, consider using a larger mat to maintain aesthetic balance.</p>
                    <p>Suggested mat size: ${suggestedMatSize.toFixed(2)} inches on all sides.</p>
                `;
            } else {
                suggestionsDiv.innerHTML = ''; // Clear suggestions for larger artwork
            }
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.text("Framing Calculator Results", 10, 10);
            // Add more content to the PDF here
            doc.save("Framing_Calculator_Results.pdf");
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            populateFractionDropdowns();
            document.getElementById('customMarginBtn').addEventListener('click', toggleCustomMargins);
        });
    </script>
</body>
</html>